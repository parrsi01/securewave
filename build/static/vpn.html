<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>VPN Configuration - SecureWave VPN</title>
  <meta name="description" content="Generate and download your WireGuard VPN configuration. Quick setup with QR code support for mobile devices.">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="/css/professional.css">
  <style>
    #qrCodeDisplay img {
      border-radius: var(--radius-lg);
    }
  </style>
</head>
<body>
  <!-- Skip to main content for accessibility -->
  <a href="#main-content" class="skip-to-main">Skip to main content</a>

  <!-- Navigation -->
  <nav class="navbar">
    <div class="navbar-container">
      <a href="/home.html" class="navbar-brand">
        <img src="/img/logo.svg" alt="SecureWave VPN Logo">
        <span>SecureWave</span>
      </a>
      <ul class="navbar-menu">
        <li><a href="/home.html">Home</a></li>
        <li><a href="/services.html">Services</a></li>
        <li><a href="/subscription.html">Pricing</a></li>
        <li><a href="/about.html">About</a></li>
        <li><a href="/contact.html">Contact</a></li>
        <li><a href="/dashboard.html" class="hidden" id="dashLink">Dashboard</a></li>
        <li><a href="/login.html" class="btn btn-ghost btn-sm" id="loginBtn">Login</a></li>
        <li><a href="/register.html" class="btn btn-primary btn-sm" id="registerBtn">Get Started</a></li>
        <li><button class="btn btn-ghost btn-sm hidden" id="logoutBtn">Logout</button></li>
      </ul>

      <!-- Mobile menu toggle -->
      <button class="navbar-toggle" aria-label="Toggle navigation menu">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
  </nav>

  <main id="main-content">
    <!-- Page Header -->
    <div style="background-color: var(--bg-secondary); border-bottom: 1px solid var(--border-primary); padding: 2rem 0;">
      <div class="container">
        <div class="badge">WireGuard Configuration</div>
        <h1 style="margin-top: 0.5rem; margin-bottom: 0.5rem;">VPN Configuration Center</h1>
        <p style="font-size: 1.125rem; color: var(--gray-500); max-width: 42rem;">
          Generate, download, and deploy your WireGuard VPN configuration in seconds. No technical knowledge required.
        </p>
      </div>
    </div>

    <!-- Main Content -->
    <div class="container" style="padding: 3rem 0;">
      <!-- Status Alert -->
      <div id="statusAlert" class="hidden" style="background-color: var(--primary-50); border: 1px solid var(--primary-200); border-radius: var(--radius-lg); padding: 1rem; margin-bottom: 2rem; display: flex; align-items: center; gap: 0.75rem;">
        <svg style="width: 1.25rem; height: 1.25rem; color: var(--primary-600);" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"/>
        </svg>
        <p id="statusMessage" style="margin: 0; color: var(--primary-800); font-weight: 500;"></p>
      </div>

      <!-- Two Column Layout -->
      <div class="grid grid-2" style="margin-bottom: 3rem;">
        <!-- Left Column: Generate Config -->
        <div class="card">
          <div class="card-body">
            <div style="display: flex; align-items: center; gap: 1rem; margin-bottom: 1.5rem;">
              <div style="display: inline-flex; align-items: center; justify-center; padding: 0.75rem; background-color: var(--primary-600); border-radius: var(--radius-md); box-shadow: var(--shadow-lg);">
                <svg style="width: 1.5rem; height: 1.5rem; color: white;" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"/>
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"/>
                </svg>
              </div>
              <div>
                <h2 style="margin: 0; font-size: 1.25rem;">Generate Configuration</h2>
                <p style="margin: 0.25rem 0 0 0; font-size: 0.875rem; color: var(--gray-500);">Create your WireGuard config</p>
              </div>
            </div>

            <p style="color: var(--gray-600); margin-bottom: 1.5rem;">
              Generate a new WireGuard configuration with AI-optimized server selection. Your private key and IP address will be automatically assigned.
            </p>

            <button id="generateConfig" class="btn btn-primary btn-block btn-lg" style="margin-bottom: 1rem;">
              Generate New Config
            </button>

            <div style="background-color: var(--bg-secondary); border-radius: var(--radius-md); padding: 1rem; margin-top: 1rem;">
              <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 0.5rem;">
                <span style="font-size: 0.75rem; font-weight: 600; color: var(--gray-700); text-transform: uppercase; letter-spacing: 0.05em;">Server Endpoint</span>
                <span class="badge">Active</span>
              </div>
              <p style="margin: 0; font-family: monospace; font-size: 0.875rem; color: var(--primary-600);">securewave-app.azurewebsites.net:51820</p>
            </div>

            <div class="grid grid-2" style="gap: 1rem; margin-top: 1.5rem;">
              <div style="text-align: center; padding: 1rem; background-color: var(--bg-secondary); border-radius: var(--radius-md);">
                <div style="font-size: 1.5rem; margin-bottom: 0.5rem;">üåç</div>
                <p style="margin: 0; font-size: 0.875rem; color: var(--gray-600);">50+ Locations</p>
              </div>
              <div style="text-align: center; padding: 1rem; background-color: var(--bg-secondary); border-radius: var(--radius-md);">
                <div style="font-size: 1.5rem; margin-bottom: 0.5rem;">‚ö°</div>
                <p style="margin: 0; font-size: 0.875rem; color: var(--gray-600);">AI Optimized</p>
              </div>
            </div>
          </div>
        </div>

        <!-- Right Column: Download & QR -->
        <div class="card">
          <div class="card-body">
            <div style="display: flex; align-items: center; gap: 1rem; margin-bottom: 1.5rem;">
              <div style="display: inline-flex; align-items: center; justify-center; padding: 0.75rem; background-color: var(--primary-600); border-radius: var(--radius-md); box-shadow: var(--shadow-lg);">
                <svg style="width: 1.5rem; height: 1.5rem; color: white;" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"/>
                </svg>
              </div>
              <div>
                <h2 style="margin: 0; font-size: 1.25rem;">Download & Setup</h2>
                <p style="margin: 0.25rem 0 0 0; font-size: 0.875rem; color: var(--gray-500);">Get your configuration</p>
              </div>
            </div>

            <p style="color: var(--gray-600); margin-bottom: 1.5rem;">
              After generating your config, download it for desktop or scan the QR code for mobile devices.
            </p>

            <button id="downloadConfig" class="btn btn-secondary btn-block btn-lg hidden" style="margin-bottom: 0.75rem;">
              <svg style="width: 1.25rem; height: 1.25rem; margin-right: 0.5rem; display: inline-block;" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M9 19l3 3m0 0l3-3m-3 3V10"/>
              </svg>
              Download Config File
            </button>

            <button id="showQR" class="btn btn-outline btn-block btn-lg hidden" style="margin-bottom: 1.5rem;">
              <svg style="width: 1.25rem; height: 1.25rem; margin-right: 0.5rem; display: inline-block;" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v1m6 11h2m-6 0h-2v4m0-11v3m0 0h.01M12 12h4.01M16 20h4M4 12h4m12 0h.01M5 8h2a1 1 0 001-1V5a1 1 0 00-1-1H5a1 1 0 00-1 1v2a1 1 0 001 1zm12 0h2a1 1 0 001-1V5a1 1 0 00-1-1h-2a1 1 0 00-1 1v2a1 1 0 001 1zM5 20h2a1 1 0 001-1v-2a1 1 0 00-1-1H5a1 1 0 00-1 1v2a1 1 0 001 1z"/>
              </svg>
              Show QR Code
            </button>

            <div id="qrCodeDisplay" style="text-align: center; min-height: 200px; display: flex; align-items: center; justify-content: center; background-color: var(--bg-secondary); border-radius: var(--radius-lg); padding: 2rem;">
              <p style="margin: 0; color: var(--gray-400);">Generate a config to view QR code</p>
            </div>
          </div>
        </div>
      </div>

      <!-- How to Use -->
      <div class="card" style="margin-bottom: 3rem;">
        <div class="card-body">
          <h2 style="margin-bottom: 0.5rem;">How to Use Your VPN Config</h2>
          <p style="color: var(--gray-600); margin-bottom: 2rem;">Follow these simple steps to get connected in minutes</p>

          <div class="grid grid-3">
            <div>
              <div style="display: inline-block; background-color: var(--primary-100); color: var(--primary-700); padding: 0.5rem 1rem; border-radius: var(--radius-md); font-weight: 600; margin-bottom: 1rem;">Step 1</div>
              <h3 style="font-size: 1.125rem; margin-bottom: 0.5rem;">Generate Config</h3>
              <p style="color: var(--gray-600); margin: 0;">Click "Generate New Config" to create your unique WireGuard configuration with AI-optimized server selection.</p>
            </div>
            <div>
              <div style="display: inline-block; background-color: var(--primary-100); color: var(--primary-700); padding: 0.5rem 1rem; border-radius: var(--radius-md); font-weight: 600; margin-bottom: 1rem;">Step 2</div>
              <h3 style="font-size: 1.125rem; margin-bottom: 0.5rem;">Download</h3>
              <p style="color: var(--gray-600); margin: 0;">Download the .conf file for desktop clients or scan the QR code with the WireGuard mobile app.</p>
            </div>
            <div>
              <div style="display: inline-block; background-color: var(--primary-100); color: var(--primary-700); padding: 0.5rem 1rem; border-radius: var(--radius-md); font-weight: 600; margin-bottom: 1rem;">Step 3</div>
              <h3 style="font-size: 1.125rem; margin-bottom: 0.5rem;">Connect</h3>
              <p style="color: var(--gray-600); margin: 0;">Import the config into your WireGuard client and activate the tunnel to start browsing securely.</p>
            </div>
          </div>
        </div>
      </div>

      <!-- Supported Platforms -->
      <div style="margin-bottom: 3rem;">
        <h2 style="text-align: center; margin-bottom: 1rem;">Supported Platforms</h2>
        <p style="text-align: center; color: var(--gray-600); margin-bottom: 3rem; max-width: 42rem; margin-left: auto; margin-right: auto;">Download WireGuard for your platform and import your configuration</p>

        <div class="grid grid-3">
          <div class="card">
            <div class="card-body" style="text-align: center;">
              <div style="font-size: 3rem; margin-bottom: 1rem;">ü™ü</div>
              <h3>Windows</h3>
              <p style="color: var(--gray-600); margin-bottom: 1.5rem;">Download WireGuard for Windows and import your .conf file</p>
              <a href="https://www.wireguard.com/install/" target="_blank" class="btn btn-outline btn-sm">Download for Windows</a>
            </div>
          </div>
          <div class="card">
            <div class="card-body" style="text-align: center;">
              <div style="font-size: 3rem; margin-bottom: 1rem;">üçé</div>
              <h3>macOS & iOS</h3>
              <p style="color: var(--gray-600); margin-bottom: 1.5rem;">Install from App Store and scan QR code or import config</p>
              <a href="https://apps.apple.com/us/app/wireguard/id1451685025" target="_blank" class="btn btn-outline btn-sm">Download from App Store</a>
            </div>
          </div>
          <div class="card">
            <div class="card-body" style="text-align: center;">
              <div style="font-size: 3rem; margin-bottom: 1rem;">ü§ñ</div>
              <h3>Android & Linux</h3>
              <p style="color: var(--gray-600); margin-bottom: 1.5rem;">Get WireGuard from Play Store or install via package manager</p>
              <a href="https://play.google.com/store/apps/details?id=com.wireguard.android" target="_blank" class="btn btn-outline btn-sm">Download for Android</a>
            </div>
          </div>
        </div>
      </div>

      <!-- Technical Specs -->
      <div class="card" style="background-color: var(--primary-50); border: 1px solid var(--primary-200);">
        <div class="card-body">
          <h2 style="margin-bottom: 0.5rem; color: var(--primary-900);">Technical Specifications</h2>
          <p style="color: var(--primary-700); margin-bottom: 2rem;">Industry-leading security and performance</p>

          <div class="grid grid-2">
            <div>
              <dl style="margin: 0;">
                <dt style="font-weight: 600; color: var(--primary-900); margin-bottom: 0.5rem;">Protocol</dt>
                <dd style="margin: 0 0 1.5rem 0; color: var(--primary-700);">WireGuard - Modern, fast, and secure VPN protocol</dd>

                <dt style="font-weight: 600; color: var(--primary-900); margin-bottom: 0.5rem;">Encryption</dt>
                <dd style="margin: 0 0 1.5rem 0; color: var(--primary-700);">ChaCha20 cipher with Poly1305 authentication</dd>

                <dt style="font-weight: 600; color: var(--primary-900); margin-bottom: 0.5rem;">Key Exchange</dt>
                <dd style="margin: 0; color: var(--primary-700);">Curve25519 for perfect forward secrecy</dd>
              </dl>
            </div>
            <div>
              <dl style="margin: 0;">
                <dt style="font-weight: 600; color: var(--primary-900); margin-bottom: 0.5rem;">AI Optimization</dt>
                <dd style="margin: 0 0 1.5rem 0; color: var(--primary-700);">MARL + XGBoost for intelligent server selection</dd>

                <dt style="font-weight: 600; color: var(--primary-900); margin-bottom: 0.5rem;">DNS</dt>
                <dd style="margin: 0 0 1.5rem 0; color: var(--primary-700);">1.1.1.1 (Cloudflare) with leak protection</dd>

                <dt style="font-weight: 600; color: var(--primary-900); margin-bottom: 0.5rem;">Network</dt>
                <dd style="margin: 0; color: var(--primary-700);">10.8.0.0/24 private address space</dd>
              </dl>
            </div>
          </div>
        </div>
      </div>
    </div>
  </main>

  <!-- Footer -->
  <footer class="footer">
    <div class="container">
      <p>&copy; 2024 SecureWave VPN. All rights reserved. | <a href="/terms.html" style="color: var(--text-tertiary);">Terms</a> | <a href="/privacy.html" style="color: var(--text-tertiary);">Privacy</a></p>
    </div>
  </footer>

  <script src="/js/main.js"></script>
  <script>
    // VPN Configuration Logic
    document.getElementById('generateConfig').addEventListener('click', async () => {
      const btn = document.getElementById('generateConfig');
      const statusAlert = document.getElementById('statusAlert');
      const statusMessage = document.getElementById('statusMessage');

      btn.disabled = true;
      btn.textContent = 'Generating...';

      try {
        const response = await fetch('/api/vpn/generate', {
          method: 'POST',
          headers: {
            'Authorization': `Bearer ${localStorage.getItem('access_token')}`
          }
        });

        if (response.ok) {
          statusAlert.classList.remove('hidden');
          statusMessage.textContent = 'Configuration generated successfully!';
          document.getElementById('downloadConfig').classList.remove('hidden');
          document.getElementById('showQR').classList.remove('hidden');
        } else if (response.status === 401) {
          window.location.href = '/login.html';
        } else {
          throw new Error('Failed to generate config');
        }
      } catch (error) {
        statusAlert.classList.remove('hidden');
        statusAlert.style.backgroundColor = 'var(--error)';
        statusAlert.style.borderColor = 'var(--error)';
        statusMessage.textContent = 'Error generating config. Please try again.';
      } finally {
        btn.disabled = false;
        btn.textContent = 'Generate New Config';
      }
    });

    document.getElementById('downloadConfig').addEventListener('click', async () => {
      window.location.href = '/api/vpn/download';
    });

    document.getElementById('showQR').addEventListener('click', async () => {
      const qrDisplay = document.getElementById('qrCodeDisplay');
      qrDisplay.innerHTML = '<p style="color: var(--gray-400);">Loading QR code...</p>';

      try {
        const response = await fetch('/api/vpn/qr', {
          headers: {
            'Authorization': `Bearer ${localStorage.getItem('access_token')}`
          }
        });

        if (response.ok) {
          const blob = await response.blob();
          const img = document.createElement('img');
          img.src = URL.createObjectURL(blob);
          img.style.maxWidth = '100%';
          img.style.borderRadius = 'var(--radius-lg)';
          qrDisplay.innerHTML = '';
          qrDisplay.appendChild(img);
        }
      } catch (error) {
        qrDisplay.innerHTML = '<p style="color: var(--error);">Failed to load QR code</p>';
      }
    });
  </script>
</body>
</html>
